Power Automate Hands On
---


# 当ハンズオンで行うこと

当ハンズオンでは、Power Automate を使用して、勤怠報告を行うフローを作成します。

# 事前に必要なもの

* Power Automate をインストール可能なスマートフォン
* Microsoft 365 Developer プログラム


# 目次

<!-- TOC -->

- [当ハンズオンで行うこと](#当ハンズオンで行うこと)
- [事前に必要なもの](#事前に必要なもの)
- [目次](#目次)
- [1. SharePoint サイトの作成](#1-sharepoint-サイトの作成)
- [2. リスト の作成](#2-リスト-の作成)
- [3. リストの列定義を設定](#3-リストの列定義を設定)
- [4. Power Automate フローの作成](#4-power-automate-フローの作成)

<!-- /TOC -->


# 1. SharePoint サイトの作成

勤怠報告のデータを格納するリストを格納するための SharePoint サイトを作成します。

1. 画面右上のアプリ起動ツールをクリックする

![](pasteimage/2020-11-27-02-18-24.png)

2. SharePoint をクリックする

![](pasteimage/2020-11-27-02-19-19.png)

3. サイトの作成をクリックする

![](pasteimage/2020-11-27-02-20-15.png)

4. チーム サイト をクリックする

![](pasteimage/2020-11-27-02-21-07.png)

5. 任意のサイト名を入力を入力後、表示される項目を適宜入力

![](pasteimage/2020-11-27-02-21-42.png)

![](pasteimage/2020-11-27-02-22-52.png)

6. 言語を日本語に変更し、次へをクリックする

![](pasteimage/2020-11-27-02-23-44.png)

7. 作成を待って、完了をクリックする

![](pasteimage/2020-11-27-02-24-31.png)

8. このような画面に遷移すれば、SharePointサイトの作成は完了。

![](pasteimage/2020-11-27-02-25-10.png)

9. 画面右上のフォローをクリックし、作成したサイトをフォローする

![](pasteimage/2020-11-27-02-31-28.png)

![](pasteimage/2020-11-27-02-31-46.png)

# 2. リスト の作成

今度は、勤怠報告データを格納するリストを作成します。

1. サイトコンテンツをクリックする

![](pasteimage/2020-11-27-03-34-35.png)

2. 新規からリストをクリックする

![](pasteimage/2020-11-27-03-35-11.png)

3. 空白のリストをクリックする

![](pasteimage/2020-11-27-03-35-46.png)

6. 任意のリスト名を入力し作成をクリックする

![](pasteimage/2020-11-27-03-37-07.png)

# 3. リストの列定義を設定

列定義を以下のように設定します

|列名|種類|必須|選択値|既定値|
|:--|:--|:--|:--|:--|
|Full_Name|1行テキスト|True|||
|Work_Status|選択肢|True|出勤・休憩開始・休憩完了・退勤|出勤|
|Latitude|1行テキスト|True|||
|Longitude|1行テキスト|True|||
|Add_Day|1行テキスト|True|||

1. 設定からリストの設定をクリックする

![](pasteimage/2020-11-27-03-49-37.png)

2. title をクリックする

![](pasteimage/2020-11-27-03-50-15.png)

3. 列名を Full_Name に変更し、OKをクリックする

![](pasteimage/2020-11-27-03-51-22.png)

4. 列の作成をクリックする

![](pasteimage/2020-11-27-03-51-59.png)

5. Work_status は選択肢を選択し、必須項目とした後、選択項目を入力後、OKをクリックする

![](pasteimage/2020-11-27-03-54-52.png)

6. 同様に、Latitude Longtitude Add_day の列を作成する

![](pasteimage/2020-11-27-04-32-51.png)

# 4. Power Automate フローの作成

`これよりPower Automate側のフローを作成していきます

1. 画面右上のアプリ起動ツールをクリックする

![](pasteimage/2020-11-27-02-18-24.png)

2. Power Automate をクリックする

![](pasteimage/2020-11-27-03-59-01.png)

3. マイフローをクリックする

![](pasteimage/2020-11-27-04-00-43.png)

4. インスタントー一から作成をクリックする

![](pasteimage/2020-11-27-04-01-25.png)

5. フロー名を入力し、手動でフローをトリガーしますをクリックし、作成をクリックする

![](pasteimage/2020-11-27-04-02-33.png)

6. 新しいステップをクリックする

![](pasteimage/2020-11-27-04-04-12.png)

7. SharePoint をクリックする

![](pasteimage/2020-11-27-04-05-10.png)

8. 項目の作成 をクリックする

![](pasteimage/2020-11-27-04-05-51.png)

9. 作成したサイトを選択する

![](pasteimage/2020-11-27-04-07-15.png)

10. 作成したリストを選択する

![](pasteimage/2020-11-27-04-08-02.png)

11. Full_Name に トリガーのユーザー名を指定する

![](pasteimage/2020-11-27-04-09-13.png)

12. Latitude に緯度、Longtitude に経度を指定する

![](pasteimage/2020-11-27-04-34-54.png)

19. Add_Day には 日付 を指定する

![](pasteimage/2020-11-27-04-35-20.png)

20. ボタントリガーの設定をクリックする

![](pasteimage/2020-11-27-10-54-30.png)

21. 赤枠で示したいづれかのトグルスイッチをオンオフし、完了をクリックする

![](pasteimage/2020-11-27-10-55-33.png)

Special Thanks @flali_world

![](pasteimage/2020-11-27-10-56-03.png)


テスト実行を行ってみて、実際に登録できているか確認してみましょう！

また、出勤以外にも退勤のボタンも作ってみましょう！