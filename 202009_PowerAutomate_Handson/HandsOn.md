Power Automate Hands On
---

# 当ハンズオンで行うこと

当ハンズオンでは、Power Automate を使用して、撮影した写真の顔から様々な情報を取得するフローを作成しています。

# 事前に必要なもの

* Power Automate をインストール可能なスマートフォン
* Microsoft アカウント

# 1. 環境準備/ログイン

Power Automate を使用するための環境を準備します。

Microsoft 365 や Power Automate 有償プランを会社でお持ちの方はそちらを利用して頂いても構いませんが、個人で自由に利用できるためのプランとして、コミュニティプランというものがありますので、是非そちらもお使いください。<br>
有償プラン ※1 と同等の機能を無償でお使い頂けます。

※1：RPA機能（UI Flows/WinAutomation）は使用できません。

## 1.1 Microsoft 365 developer program への参加

* 既に Microsoft 365 アカウントをお持ちの方はこの内容をスキップしてください。

1. Microsoft 365 Developer プログラムのサイトにアクセスします。

[Microsoft 365 Developer プログラム](https://developer.microsoft.com/ja-jp/microsoft-365/dev-program)

2. 参加するをクリックします。

![](pasteimage/2020-09-30-00-57-46.png)

3. Microsoft アカウントでサインインします。

![](pasteimage/2020-09-30-00-59-51.png)

4. 国名と会社名と言語設定をそれぞれ指定し、次へをクリックします。

![](pasteimage/2020-09-30-01-01-22.png)

![](pasteimage/2020-09-30-01-02-52.png)

5. 該当するものにチェックを入れて、参加をクリックします。

![](pasteimage/2020-09-30-01-04-39.png)

6. E5 サブスクリプションのセットアップをクリックします。

![](pasteimage/2020-09-30-01-05-43.png)

7. 適宜任意のものを入れていき、続行をクリックします。

![](pasteimage/2020-09-30-01-07-28.png)

8. SMS使用可能な電話番号を入力し、コードの送信をクリックします。

![](pasteimage/2020-09-30-01-08-26.png)

9. SMSにワンタイムパスワードが送られたら、コードを入力しセットアップをクリックします。

![](pasteimage/2020-09-30-01-10-12.png)

10. サブスクリプションに移動するをクリックします。

![](pasteimage/2020-09-30-01-11-15.png)

11. 作成したアカウントのパスワードでサインインします。

![](pasteimage/2020-09-30-01-11-51.png)

12. 管理をクリックします。

![](pasteimage/2020-09-30-01-14-19.png)

13. Microsoft 365 のアカウントをクリックします。

![](pasteimage/2020-09-30-01-14-59.png)

14. ユーザーを展開し、アクティブなユーザーをクリックします。

![](pasteimage/2020-09-30-01-15-52.png)

15. アカウントを選択し、製品ライセンスの管理をクリックします。

![](pasteimage/2020-09-30-01-17-30.png)

16. ライセンスにチェックが入っていることを確認し、変更の保存をクリックします。

![](pasteimage/2020-09-30-01-18-23.png)


## 1.2 Azure 環境の準備

* 既に Azure アカウントをお持ちの方はこの内容をスキップしてください。
* 1.1 をスキップされた方は、お持ちのMicrosoft 365 アカウントを用いて予めサインインしておいてください。

1. Azure にアクセスします。

[Azure](https://azure.microsoft.com/ja-jp/)

![](pasteimage/2020-09-30-01-19-44.png)

2. Azure を無料で試すをクリックします。

![](pasteimage/2020-09-30-01-20-18.png)

3. 無料で始めるをクリックします。

![](pasteimage/2020-09-30-01-21-00.png)

4. Microsoft 365 のアカウントをクリックします。

![](pasteimage/2020-09-30-01-21-51.png)

5. プロフィールを確認し、次へをクリックします。

![](pasteimage/2020-09-30-01-23-50.png)

6. 電話による本人確認を行います

![](pasteimage/2020-09-30-01-25-25.png)

7. クレジットカードによる本人確認を行います。

![](pasteimage/2020-09-30-01-28-22.png)

※デビッドカード可

8. アグリーメントにて同意し、サインアップをクリックします。

![](pasteimage/2020-09-30-01-29-28.png)

9. サインインアカウントを選択します。

![](pasteimage/2020-09-30-01-30-53.png)

10. ポータルに移動します。

![](pasteimage/2020-09-30-01-31-23.png)

11. ホームをクリックします

![](pasteimage/2020-09-30-01-32-23.png)

12. ポータルが表示されます。

![](pasteimage/2020-09-30-01-32-46.png)

## 1.3 Power Apps Community Plan のサインアップ

* 1.1 をスキップされた方で、Microsoft 365アカウントに既にCommunity Plan の環境がある方は、スキップしてください。
* それ以外の方はMicrosoft 365 のアカウントでサインインしておいてください。

1. Power Apps コミュニティプラン サイトにアクセスします。

[Power Apps Community Plan](https://powerapps.microsoft.com/ja-jp/communityplan/)

2. 個人環境の作成をクリックします。

![](pasteimage/2020-09-30-01-37-18.png)

3. Microsoft 365 アカウントを選択します。

![](pasteimage/2020-09-30-01-38-01.png)

4. 国名を選択して、同意するをクリックします。

![](pasteimage/2020-09-30-01-38-48.png)

5. 環境をクリックして、default 環境以外が表示されていることを確認してください。

![](pasteimage/2020-09-30-01-43-30.png)

## 1.4 Power Automate アプリのインストール

* 既にスマートフォンにPower Automate がインストールされている方は1及び2をスキップしてください。

※写真はiOS版のものですが、Androidでも基本的には同じです。

1. App Store や Google Store にて Power Automate を検索します。

![](../202007_PowerAutomate_Handson/pasteimage/2020-07-25-12-31-37.png)

2. Power Automate が表示されるので、インストールを行います。

![](../202007_PowerAutomate_Handson/pasteimage/2020-07-25-12-34-21.png)

3. 作業の開始をタップし、サインインを行います。

![](../202007_PowerAutomate_Handson/pasteimage/2020-07-25-12-37-26.png)

4. アカウントをタップします。

![](../202007_PowerAutomate_Handson/pasteimage/2020-07-25-12-38-47.png)

5. 環境をタップし、先ほど作成した環境を選択してOKをタップします。

![](../202007_PowerAutomate_Handson/pasteimage/2020-07-25-12-43-56.png)

6. もう一度アカウントをタップし、環境名が正しく変更されていることを確認します。

![](../202007_PowerAutomate_Handson/pasteimage/2020-07-25-12-46-07.png)

# 2. Azure側の準備

## 2.1. リソースグループの作成

1. リソースグループをクリックします。

![](pasteimage/2020-03-16-03-45-02.png)

2. 「追加」をクリックします。

![](pasteimage/2020-03-16-03-45-57.png)

3. リソースグループのパラメータを指定します。

![](pasteimage/2020-03-16-03-50-08.png)

4. 作成をクリックします。

![](pasteimage/2020-03-16-03-51-44.png)

## 2.2. ストレージアカウントの作成

1. 作成したリソースグループから「追加」をクリックします。

![](pasteimage/2020-03-16-03-55-20.png)

2. ストレージアカウントを選択します。

![](pasteimage/2020-03-16-04-01-02.png)

3. ストレージアカウントのパラメータを指定します。

![](pasteimage/2020-03-16-04-05-47.png)

4. 作成をクリックします。

![](pasteimage/2020-03-16-04-07-01.png)

## 2.3. Face APIの作成

1. 作成したリソースグループから「追加」をクリックします。

![](pasteimage/2020-03-16-03-55-20.png)

2. Faceを選択します。

![](pasteimage/2020-03-16-04-12-43.png)

3. 作成をクリックします。

![](pasteimage/2020-03-16-04-12-27.png)

4. Faceのパラメータを指定します。

![](pasteimage/2020-03-16-04-15-34.png)

## 2.4 各種リソースの準備

1. 作成済みのストレージアカウントを開きます。

![](pasteimage/2020-03-16-19-02-25.png)

2. コンテナーを開きます。

![](pasteimage/2020-03-16-19-04-10.png)

3. コンテナーを作成します。

![](pasteimage/2020-03-16-19-12-20.png)

4. ストレージアカウントのアクセスキーを取得します。

![](pasteimage/2020-03-16-19-25-02.png)

5. 作成済みのFace APIを開き、アクセスキーを取得します。

![](pasteimage/2020-03-16-19-30-52.png)

# 3.Power Automate の作成

1. Power Automate を起動します。

![](pasteimage/2020-09-30-02-05-51.png)

2. 環境をコミュニティプランに切り替えます。

![](pasteimage/2020-09-30-02-06-33.png)

3. 開発者環境である旨の通知が表示されていることを確認します。

![](pasteimage/2020-09-30-02-07-12.png)

4. マイフローをクリックします。

![](pasteimage/2020-09-30-02-07-51.png)

5. インスタントから作成をクリックします。

![](pasteimage/2020-09-30-02-08-30.png)

6. 任意の名称を入力し、手動でフローをトリガーしますを選択して作成をクリックします。

![](pasteimage/2020-09-30-02-09-26.png)

7. 手動でフローをトリガーしますを選択し、入力の追加からファイルをクリックします。

![](pasteimage/2020-09-30-02-10-40.png)

![](pasteimage/2020-09-30-02-10-55.png)

8. 新しいステップをクリックし、Azure Blob Storage から Blobの作成をクリックします。

![](pasteimage/2020-09-30-02-12-08.png)

9. 無料体験をクリックします

![](pasteimage/2020-09-30-02-12-42.png)

10. ストレージアカウントの接続情報を登録します。

![](pasteimage/2020-09-30-02-14-58.png)

11. フォルダーのパスにコンテナ名を入力し、ファイル名は任意のもの、Blobコンテンツにトリガーのファイルコンテンツを指定します。

![](pasteimage/2020-09-30-02-16-11.png)

12. 新しいステップをクリックし、Azure Blob Storage から、パスを使用してSAS URIを作成するをクリックします。

![](pasteimage/2020-09-30-02-18-39.png)

13. BLOBパスにBlobの作成からPathを指定します。

![](pasteimage/2020-09-30-02-19-22.png)

14. 新しいステップをクリックし、Face APIからDetect faces をクリックします。

![](pasteimage/2020-09-30-02-20-53.png)

15. Face API の接続情報を登録します。

![](pasteimage/2020-09-30-02-22-11.png)

16. Image Url に パスを使用してSAS URIを作成するの WebURLを指定します。

![](pasteimage/2020-09-30-02-23-37.png)

17. 戻り値を通知したり、Twitterに上げてみるなどしてみてください！

![](pasteimage/2020-09-30-02-24-57.png)